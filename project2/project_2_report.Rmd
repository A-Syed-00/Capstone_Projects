---
title: "DUI Incident Rates in Boston from 2019, 2021-2023"
author: "Asma Syed"
date: "2023-12-17"
output:
  html_document:
    df_print: paged
---

## Introduction

This project analyzes DUI (drunk driving incidents) in Boston to identify patterns related to holidays, weekends, and seasonal trends. National statistics suggest higher risk during these times. For example, Driver's Ed reports that 25% of adults consume more alcohol during the holiday season, and Injury Facts identifies Saturday as the most dangerous day to drive.

The data set is sourced from from the Boston Police Department Database: https://data.boston.gov/dataset/crime-incident-reports-august-2015-to-date-source-new-system
The analysis focuses on DUI incidents from the years 2019, 2021, 2022, and 2023. 


## Data Cleaning and Preperation 

```{r, message=FALSE, include=FALSE}
setwd("~/Downloads/STA 419")

crime19 <- read.csv("CrimeData19.csv") 
crime21 <- read.csv("CrimeData21.csv") 
crime22 <- read.csv("CrimeData22.csv") 
crime23 <- read.csv("CrimeData23.csv") 
library(tidyverse)
library(caret)
```

After loading the data into R, there were four separate data sets with 17 variables each. The 2019 dataset had 87,184 incidents, the 2021 data had 71,721 incidents, the 2022 data had 73,852, and lastly the 2023 data had 74,040 incidents. The year 2023 data set is incomplete, with the most recent incident recorded on December 12, 2023. 


The data sets were combined into a single data set totaling 306,797 observations. To focus the analysis on DUI related incidents, all other crime types were filtered out. 

```{r, include=FALSE}
crimedata <- rbind(crime19, crime21, crime22,crime23)
```
 
The resulting data set consists 373 reported DUI incidents and the following variables: 
 
| Variable             | Description                                  |
|----------------------|----------------------------------------------|
| OFFENSE_CODE         | Code assigned to each type of crime          |
| OFFENSE_DESCRIPTION  | Description of the crime                     |
| OCCURRED_ON_DATE     | Date and time when the crime occurred        |
| YEAR                 | Year in which the crime occurred             |
| MONTH                | Month in which the crime occurred            |
| DAY_OF_WEEK          | Day of the week when the crime occurred      |

```{r, include=FALSE}
crimeDUI <- crimedata %>% 
  select(OFFENSE_CODE,OFFENSE_DESCRIPTION,OCCURRED_ON_DATE, YEAR, MONTH, DAY_OF_WEEK) %>% 
  filter(OFFENSE_CODE==2101)
crimeDUI
```
 

```{r, include=FALSE}
dat_new<-substr(crimeDUI$OCCURRED_ON_DATE, 1,10)
dat_new

crimeDUI$dates <- dat_new


crimeDUI %>% 
  mutate(dat_new)
crimeDUI
```

To analyze trends related to holidays, weekends, and warmer months, additional columns were created to classify each observation accordingly. 
The following holidays were considered: 

1. New Year’s Day  
2. Super Bowl Sunday  
3. President’s Day  
4. St. Patrick’s Day  
5. Memorial Day  
6. Juneteenth  
7. Fourth of July  
8. Labor Day  
9. Halloween  
10. Thanksgiving  
11. Christmas Eve  
12. Christmas Day  
13. New Year’s Eve
 
Observations from May through September were classified as occurring in warmer months. These classifications were implemented in R using the `mutate()` function along with the `case_when()` function. 
```{r, include=FALSE}
crimeDUI <- crimeDUI %>% 
  mutate(holiday= case_when(dates == "2022-01-01" ~ "1",
                            dates == "2022-02-13" ~ "1",
                            dates == "2022-02-21" ~ "1",
                            dates == "2022-03-17" ~ "1",
                            dates == "2022-05-30" ~ "1",
                            dates == "2022-06-19" ~ "1",
                            dates == "2022-07-04" ~ "1",
                            dates == "2022-09-05" ~ "1",
                            dates == "2022-10-31" ~ "1",
                            dates == "2022-11-24" ~ "1",
                            dates == "2022-12-24" ~ "1", 
                            dates == "2022-12-25" ~ "1",
                            dates == "2022-12-31" ~ "1",
                            
                            dates == "2023-01-01" ~ "1",
                            dates == "2023-02-12" ~ "1",
                            dates == "2023-02-20" ~ "1",
                            dates == "2023-03-17" ~ "1",
                            dates == "2023-05-29" ~ "1",
                            dates == "2023-06-19" ~ "1",
                            dates == "2023-07-04" ~ "1",
                            dates == "2023-09-04" ~ "1",
                            dates == "2023-10-31" ~ "1",
                            dates == "2023-11-23" ~ "1",
                            dates == "2023-12-24" ~ "1",
                            dates == "2023-12-25" ~ "1",
                            dates == "2023-12-31" ~ "1",
                            
                            dates == "2021-01-01" ~ "1",
                            dates == "2021-02-07" ~ "1",
                            dates == "2021-02-15" ~ "1",
                            dates == "2021-03-17" ~ "1",
                            dates == "2021-05-31" ~ "1",
                            dates == "2021-06-19" ~ "1",
                            dates == "2021-07-04" ~ "1",
                            dates == "2021-09-06" ~ "1",
                            dates == "2021-10-31" ~ "1",
                            dates == "2021-11-25" ~ "1",
                            dates == "2021-12-24" ~ "1",
                            dates == "2021-12-25" ~ "1",
                            dates == "2021-12-31" ~ "1",
                            
                            dates == "2019-01-01" ~ "1",
                            dates == "2019-02-03" ~ "1",
                            dates == "2019-02-18" ~ "1",
                            dates == "2019-03-17" ~ "1",
                            dates == "2019-05-27" ~ "1",
                            dates == "2019-06-19" ~ "1",
                            dates == "2019-07-04" ~ "1",
                            dates == "2019-09-02" ~ "1",
                            dates == "2019-10-31" ~ "1",
                            dates == "2019-11-28" ~ "1",
                            dates == "2019-12-24" ~ "1",
                            dates == "2021-12-25" ~ "1",
                            dates == "2021-12-31" ~ "1",
                            
                            
                          ))
           
crimeDUI <- crimeDUI %>%
  mutate(weekend= case_when(DAY_OF_WEEK=="Saturday" ~ "1", 
                            DAY_OF_WEEK=="Sunday" ~ "1"))

#more drunk driving in warmer months? May-Sep

crimeDUI <- crimeDUI %>% 
  mutate(warm_months= case_when(MONTH >= 5 & MONTH <= 9 ~ "1"))

crimeDUI$holiday[is.na(crimeDUI$holiday)] <- 0
  
crimeDUI$weekend[is.na(crimeDUI$weekend)] <- 0

crimeDUI$warm_months[is.na(crimeDUI$warm_months)] <- 0
```



## Statistical Analysis and Model Building 

Given that the data set contains a single response variable, a linear model was not suitable for analysis. Instead, summray statistics were computed to explore trends in DUI incidents.
```{r, include=FALSE}
crimeDUI %>% 
  group_by(YEAR) %>% 
  summarize(count= n())
```

First, the number of incidents per year was summarized. Next, incidents were categorized by holidays, where 0= non-holiday and 1 = holiday. Analysis revealed that only 2.6% of DUI incidents occurred during the holidays, suggesting that the majority of incidents happen on regular days. 
```{r, message=FALSE,echo=FALSE, include = FALSE}
library (dplyr)
library(knitr)
holiday_summary <- crimeDUI %>% 
  group_by(YEAR, holiday) %>% 
  summarize(count=n(), .groups="drop")
kable(holiday_summary, caption = "Incidents by Year and Holiday Status")

```
Further analysis grouped incidents by: 

 1. Year and weekends: 0=weekdays, 1= weekends
    + Approximately 40% of DUI incidents occurred on weekends, while 60% occurred on weekdays. 
    
2. Year and warmer months: 0= colder months (October-April), 1= warmer months (May-September)
    + About 40% of incidents occurred during the warmer months, with the remaining 60% in colder months. 



```{r, message=FALSE, echo=FALSE, include=FALSE}
weekend_summary <- crimeDUI %>% 
  group_by(YEAR, weekend) %>% 
  summarize(count=n(), .groups="drop")
kable(weekend_summary, caption="Incidents by Year and Weekends")

```

```{r, message=FALSE, echo=FALSE, include=FALSE}
warm_months_summary <- crimeDUI %>% 
  group_by(YEAR, warm_months) %>% 
  summarize(count=n(), .groups="drop")
  kable(warm_months_summary, caption="Incidents by Year and Warm vs Cold Months")
```
For weekends, more accidents occurred during the weekdays- about 40% of DUI incidents occurred during the weekend and 60% during the weekdays.  
For warmer months, about 40% of DUI incidents occurred between May and September while 60% occurred during the colder months. 

Bar plots were generated to visualize trends in each variable of interest by year, showing patterns in DUI incidents across holidays, weekends, and warmer months. 

```{r, message=FALSE, echo=FALSE}

get_percentage <- function(data, group_var, fill_var) {
  data %>%
    group_by({{group_var}}, {{fill_var}}) %>%
    summarise(count = n(), .groups = "drop") %>%
    group_by({{group_var}}) %>%
    mutate(percentage = count / sum(count) * 100)
}

holiday_summary <- get_percentage(crimeDUI, YEAR, holiday)

ggplot(holiday_summary, aes(x = factor(YEAR), y = count, fill = factor(holiday))) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(round(percentage,1), "%")), 
            position = position_stack(vjust = 0.5), size = 4) +
  scale_fill_brewer(palette = "Pastel1", labels = c("Non-Holiday", "Holiday")) +
  labs(
    title = "DUI Incidents in Boston by Holiday Status",
    x = "Year",
    y = "Number of Incidents",
    fill = "Day Type"
  ) +
  theme_minimal(base_size = 14)

# DUI incidents by weekend
weekend_summary <- get_percentage(crimeDUI, YEAR, weekend)

ggplot(weekend_summary, aes(x = factor(YEAR), y = count, fill = factor(weekend))) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(round(percentage,1), "%")), 
            position = position_stack(vjust = 0.5), size = 4) +
  scale_fill_brewer(palette = "Pastel2", labels = c("Weekday", "Weekend")) +
  labs(
    title = "DUI Incidents in Boston by Weekday vs. Weekend",
    x = "Year",
    y = "Number of Incidents",
    fill = "Day Type"
  ) +
  theme_minimal(base_size = 14)

# DUI incidents by warm months
warm_summary <- get_percentage(crimeDUI, YEAR, warm_months)

ggplot(warm_summary, aes(x = factor(YEAR), y = count, fill = factor(warm_months))) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(round(percentage,1), "%")), 
            position = position_stack(vjust = 0.5), size = 4) +
  scale_fill_brewer(palette = "Purples", labels = c("Colder Months", "Warmer Months")) +
  labs(
    title = "DUI Incidents in Boston by Month Type",
    x = "Year",
    y = "Number of Incidents",
    fill = "Month Type"
  ) +
  theme_minimal(base_size = 14)




```


## Conclusions 

While the initial hypothesis suggested a higher proportion of DUI incidents in Boston during holidays, weekends, and warmer months, the analysis of four years of data did not support this assumption. The results indicate that the majority of DUI incidents occurred outside of the holidays with more incidents on weekdays than weekends, and more incidents during the colder months than warmer months. 

These findings highlight the importance of considering data scope and limitations. Since there are only four years of data, broader trends cannot be conclusively determined. Extending the analysis to include data from the past 10-15 years and incorporating additional factors like time of day could provide a more comprehensive understanding of DUI patterns in Boston. 
