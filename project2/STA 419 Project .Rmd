---
title: "DUI Incident Rates in Boston from 2019, 2021-2023"
author: "Asma Syed"
date: "2023-12-17"
output:
  html_document:
    df_print: paged
---

# About The Dataset

  Is it true that there are more drunk driving incidents around the holidays and the weekends? Doing a quick search will yield a startlingly large amount of alarming statistics about DUI related crime.  
According to Driver's ed, "25% of adults admit that they drink more during the holiday season," and according to Injury Facts, "Saturday is the most dangerous day of the week to drive." While these statistics are a culmination of data collected throughout the years and across the United States, an inquiry may arise about the DUI statistics within a particular city. This is where my research question comes into play, specifically about the number of DUI incidents in the city of Boston. I wanted to investigate the correlation between drunk driving incidents around the holidays, weekends, and months with warm weather within the city of Boston. I would then use the data to determine how well my model would be for predicting DUI's in the next year. 
My data set comes from the Boston Police Department Database: https://data.boston.gov/dataset/crime-incident-reports-august-2015-to-date-source-new-system
For this project, I decided to focus on the years 2019, 2021, 2022, and 2023.



# Data Management 

Before doing any analysis, I needed to complete a few steps of data management. 
```{r, message=FALSE, include=FALSE}
setwd("~/Downloads/STA 419")

crime19 <- read.csv("CrimeData19.csv") 
crime21 <- read.csv("CrimeData21.csv") 
crime22 <- read.csv("CrimeData22.csv") 
crime23 <- read.csv("CrimeData23.csv") 
library(tidyverse)
library(caret)
```
After loading the data onto R studio, I had 4 seperate data sets with 17 variables each. The 2019 data set had a total of 87,184 observations, the 2021 data set had a total pf 71,721 observations, the 2022 data set had a total of 73,852 observations, and, lastly, the 2023 data set had a total of 74,040 observations. Note that the 2023 is incomplete as the full year has not yet elapsed, the last crime incident that was entered occured on December 12, 2023. 
Next, I wished to combine all 4 data sets into one. I accomplished this by utilizing cbind: 

```{r, include=FALSE}
crimedata <- rbind(crime19, crime21, crime22,crime23)
```
The combined data set, crimedata, consists of 306,797 observations in total. 
Since my focus was exclusively on DUI incidents, I needed to filter out all other crimes from the data set. 
I created a new data set, *crimeDUI* which consists of reported DUI crimes only and which has the following variables: 


| Variable             | Description                                  |
|----------------------|----------------------------------------------|
| OFFENSE_CODE         | Code assigned to each type of crime          |
| OFFENSE_DESCRIPTION  | Description of the crime                     |
| OCCURRED_ON_DATE     | Date and time when the crime occurred        |
| YEAR                 | Year in which the crime occurred             |
| MONTH                | Month in which the crime occurred            |
| DAY_OF_WEEK          | Day of the week when the crime occurred      |

```{r, include=FALSE}
crimeDUI <- crimedata %>% 
  select(OFFENSE_CODE,OFFENSE_DESCRIPTION,OCCURRED_ON_DATE, YEAR, MONTH, DAY_OF_WEEK) %>% 
  filter(OFFENSE_CODE==2101)
crimeDUI
```
My new dataset has a total of 373 observations or a total of 373 reported DUI incidents within the four years. 

Next, I created a column, called **dates** within the dataset that substrings the character values under the variable **MONTH** and translates them into the format I wish to work with. In this case, I wanted the yy-mm-dd format: 
```{r, include=FALSE}
dat_new<-substr(crimeDUI$OCCURRED_ON_DATE, 1,10)
dat_new

crimeDUI$dates <- dat_new


crimeDUI %>% 
  mutate(dat_new)
crimeDUI
```

Then, I needed columns that distinguish holidays, weekends and warmer months from 'regular days', 'work days', and 'colder months'. 
I considered the following holidays: 

1. New Year’s Day  
2. Super Bowl Sunday  
3. President’s Day  
4. St. Patrick’s Day  
5. Memorial Day  
6. Juneteenth  
7. Fourth of July  
8. Labor Day  
9. Halloween  
10. Thanksgiving  
11. Christmas Eve  
12. Christmas Day  
13. New Year’s Eve
 
For warm months, I considered May until (and including) September
To do that, I used the mutate function and the case_when function: 
```{r, include=FALSE}
crimeDUI <- crimeDUI %>% 
  mutate(holiday= case_when(dates == "2022-01-01" ~ "1",
                            dates == "2022-02-13" ~ "1",
                            dates == "2022-02-21" ~ "1",
                            dates == "2022-03-17" ~ "1",
                            dates == "2022-05-30" ~ "1",
                            dates == "2022-06-19" ~ "1",
                            dates == "2022-07-04" ~ "1",
                            dates == "2022-09-05" ~ "1",
                            dates == "2022-10-31" ~ "1",
                            dates == "2022-11-24" ~ "1",
                            dates == "2022-12-24" ~ "1", 
                            dates == "2022-12-25" ~ "1",
                            dates == "2022-12-31" ~ "1",
                            
                            dates == "2023-01-01" ~ "1",
                            dates == "2023-02-12" ~ "1",
                            dates == "2023-02-20" ~ "1",
                            dates == "2023-03-17" ~ "1",
                            dates == "2023-05-29" ~ "1",
                            dates == "2023-06-19" ~ "1",
                            dates == "2023-07-04" ~ "1",
                            dates == "2023-09-04" ~ "1",
                            dates == "2023-10-31" ~ "1",
                            dates == "2023-11-23" ~ "1",
                            dates == "2023-12-24" ~ "1",
                            dates == "2023-12-25" ~ "1",
                            dates == "2023-12-31" ~ "1",
                            
                            dates == "2021-01-01" ~ "1",
                            dates == "2021-02-07" ~ "1",
                            dates == "2021-02-15" ~ "1",
                            dates == "2021-03-17" ~ "1",
                            dates == "2021-05-31" ~ "1",
                            dates == "2021-06-19" ~ "1",
                            dates == "2021-07-04" ~ "1",
                            dates == "2021-09-06" ~ "1",
                            dates == "2021-10-31" ~ "1",
                            dates == "2021-11-25" ~ "1",
                            dates == "2021-12-24" ~ "1",
                            dates == "2021-12-25" ~ "1",
                            dates == "2021-12-31" ~ "1",
                            
                            dates == "2019-01-01" ~ "1",
                            dates == "2019-02-03" ~ "1",
                            dates == "2019-02-18" ~ "1",
                            dates == "2019-03-17" ~ "1",
                            dates == "2019-05-27" ~ "1",
                            dates == "2019-06-19" ~ "1",
                            dates == "2019-07-04" ~ "1",
                            dates == "2019-09-02" ~ "1",
                            dates == "2019-10-31" ~ "1",
                            dates == "2019-11-28" ~ "1",
                            dates == "2019-12-24" ~ "1",
                            dates == "2021-12-25" ~ "1",
                            dates == "2021-12-31" ~ "1",
                            
                            
                          ))
           
crimeDUI <- crimeDUI %>%
  mutate(weekend= case_when(DAY_OF_WEEK=="Saturday" ~ "1", 
                            DAY_OF_WEEK=="Sunday" ~ "1"))

#more drunk driving in warmer months? May-Sep

crimeDUI <- crimeDUI %>% 
  mutate(warm_months= case_when(MONTH >= 5 & MONTH <= 9 ~ "1"))

crimeDUI$holiday[is.na(crimeDUI$holiday)] <- 0
  
crimeDUI$weekend[is.na(crimeDUI$weekend)] <- 0

crimeDUI$warm_months[is.na(crimeDUI$warm_months)] <- 0
```



# Statistical Analysis and Model Building 
For my analysis, since the data set has only one value for the response, a linear model wouldn't have been the ideal method to analyze data. Instead, I performed some summary statistics. i first wanted to see how many incidents there were each year: 
```{r, include=FALSE}
crimeDUI %>% 
  group_by(YEAR) %>% 
  summarize(count= n())
```

Then I wanted to see how many incidents occurred during the holidays each year and how many occurred on regular days. For this table, 0 = Non-holidays of that particular year and 1 = All holidays  
```{r, message=FALSE,echo=FALSE}
library (dplyr)
library(knitr)
holiday_summary <- crimeDUI %>% 
  group_by(YEAR, holiday) %>% 
  summarize(count=n(), .groups="drop")
kable(holiday_summary, caption = "Incidents by Year and Holiday Status")

```
It seems like more accidents occurred outside of the holidays than during the holidays. Only about 2.6% of DUI incidents occurred during the holidays

Next, I grouped the data by:

1. Year and weekends:  0 = Weekdays of the year and 1 = Weekends of the year 
2. Year and Warmer months: 0 = Months of the year that are not between May and September and 1 = Months of the year that are between May and September

```{r, message=FALSE, echo=FALSE}
weekend_summary <- crimeDUI %>% 
  group_by(YEAR, weekend) %>% 
  summarize(count=n(), .groups="drop")
kable(weekend_summary, caption="Incidents by Year and Weekends")

```

```{r, message=FALSE, echo=FALSE}
warm_months_summary <- crimeDUI %>% 
  group_by(YEAR, warm_months) %>% 
  summarize(count=n(), .groups="drop")
  kable(warm_months_summary, caption="Incidents by Year and Warm vs Cold Months")
```
For weekends, more accidents occurred during the weekdays- about 40% of DUI incidents occurred during the weekend and 60% during the weekdays.  
For warmer months, about 40% of DUI incidents occurred between May and September while 60% occurred during the colder months. 

Below are bar plots of each of the variables of interest by year: 

```{r, message=FALSE, echo=FALSE}
ggplot(crimeDUI, aes(x=YEAR, fill=holiday)) + geom_bar() + ggtitle("DUI Incidents in the City of Boston") + xlab("Years") + ylab("Number of Incidents") + scale_fill_brewer(palette="Pastel1",  labels = c("Non-Holiday", "Holiday"))

ggplot(crimeDUI, aes(x=YEAR, fill=weekend)) + geom_bar() + ggtitle("DUI Incidents in the City of Boston") + xlab("Years") + ylab("Number of Incidents") + scale_fill_brewer(palette="Pastel2",  labels = c("Weekday", "Weekend"))

ggplot(crimeDUI, aes(x=YEAR, fill=warm_months)) + geom_bar() +  ggtitle("DUI Incidents in the City of Boston") + xlab("Years") + ylab("Number of Incidents") + scale_fill_brewer(palette="Purples", labels = c("Colder Months", "Warmer Months"))

```


# Conclusions 

Although my initial assumption of there being a larger proportion of DUI accidents in Boston during the holidays, weekends, and the summer months was incorrect, I can assume that because I only had data for four years, I cannot make that larger assumption that a large number of DUI accidents in Boston occur around these times of the year. Based on my analysis, I can see why there are a larger number of accidents in the winter months and this is due to the holiday season, even though not many accidents occurred on holidays themselves. Perhaps different conclusions can be reached if I were to analyze data from 10 or 15 years and that I could have gotten a different picture if I also factored in what times of the day do DUI accidents most frequently occur.

