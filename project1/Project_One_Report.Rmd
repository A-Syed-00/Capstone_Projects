---
title: Using the GSS to Visualize People's Opinions on Traditional Gender Roles in
  the United States
author: "Asma Syed"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
---
## TL;DR 
This project analyzes General Social Survey (GSS) data to examine the attitude of Americans towards traditional gender roles. Multiple imputation was used to address missing survey responses. Logistic regression results indicate that several demographics, particularly political views and age, are significant predictors of attitudes on traditional gender roles. 


## Introduction 
 
The **General Social Survey (GSS)** is a nationally representative survey conducted in the United States since 1972 which collects information on demographic characteristics, behaviors, and attitudes of Americans.  
This project focuses on survey questions related to **opinions on traditional gender roles**, and examines how responses vary across demographic groups. 

## Research Questions 

* Are attitudes on traditional gender roles associated with demographic factors? 
* Does political ideology significantly predict agreement with traditional gender roles? 

The demographic characteristics (explanatory variables) that were examined are described in the data dictionary. 
The response variables reflecting the GSS survey questions on traditional gender roles include: 
1. **HUBBYWK1**: "Do you agree or disagree that a man's job is to earn money and a woman's job is to look after the home and family?"
2. **FAMSUFFR**: "Do you agree or disagree that all in all, family life suffers when a woman has a full-time job?"


---

## Data Dictionary

| Variable   | Description                                                   | Categories / Notes             
|------------|---------------------------------------------------------------|---------------------------------
| BALLOT     | Ballot administered with survey questions                     | Ballot (A= 1, B = 2, C = 3)
| RACE       | Respondent’s Race                                             | Black, White, Other                          |
| AGE        | Respondent’s Age                                              | 18-89 Years                                  |
| SEX        | Respondent’s Sex                                              | Binary (1 = Male, 2 = Female)                |
| MARITAL    | Marital Status                                                | 5 categories                                 |
| MARTYPE    | Marital Type                                                  | Heterosexual, Same-Sex Marriage, Not Sure
| INCOME     | Total Family Income                                           | 12 categories                                |
| HRS1       | Hours Worked Last Week                                        | 0-89 Hours                                   |
| WRKSTAT    | Labor Force Status                                            | 8 categories                                 |
| DEGREE     | Respondent’s Degree                                           | Likert scale 0-5                                          |
| POLVIEWS   | Political Views                                               | Likert scale 1-7                             |
| REGION     | Respondent’s Region in US                                     | 9 categories                                 |
| BORN       | Was Respondent Born in the US?                                | Binary (1 = Yes, 2 = No)                     |
| HUBBYWK1   | Response Variable                                             | Likert scale 1-5                             |
| FAMSUFFR   | Response Variable                                             | Likert scale 1-5                             |

## Data Cleaning and Preperation 

#### Study Population 

The data set was extracted from the General Social Survey (GSS) Data Explorer database and variables of interest were selected after considering their possible influence on people's attitudes towards traditional gender roles. The full data set consists of 72,390 observations and 20 variables. 
To focus on the 2022 survey population, the analysis was restricted to responses from that year resulting in a total of 3,544 respondents. 
  
```{r setup from GSS, echo=FALSE, message=FALSE, include=FALSE}
library(foreign)
  read.dct <- function(dct, labels.included = "yes") {
      temp <- readLines(dct)
      temp <- temp[grepl("_column", temp)]
      switch(labels.included,
             yes = {
                 pattern <- "_column\\(([0-9]+)\\)\\s+([a-z0-9]+)\\s+(.*)\\s+%([0-9]+)[a-z]\\s+(.*)"
                 classes <- c("numeric", "character", "character", "numeric", "character")
                 N <- 5
                 NAMES <- c("StartPos", "Str", "ColName", "ColWidth", "ColLabel")
             },
             no = {
                 pattern <- "_column\\(([0-9]+)\\)\\s+([a-z0-9]+)\\s+(.*)\\s+%([0-9]+).*"
                 classes <- c("numeric", "character", "character", "numeric")
                 N <- 4
                 NAMES <- c("StartPos", "Str", "ColName", "ColWidth")
             })
      temp_metadata <- setNames(lapply(1:N, function(x) {
          out <- gsub(pattern, paste("\\", x, sep = ""), temp)
          out <- gsub("^\\s+|\\s+$", "", out)
          out <- gsub('\"', "", out, fixed = TRUE)
          class(out) <- classes[x] ; out }), NAMES)
      temp_metadata[["ColName"]] <- make.names(gsub("\\s", "", temp_metadata[["ColName"]]))
      temp_metadata
  }

  read.dat <- function(dat, metadata_var, labels.included = "yes") {
      read.table(dat, col.names = metadata_var[["ColName"]])
  }


GSS_metadata <- read.dct("~/Downloads/STA 490/Proj23/GSS.dct") 
GSS_ascii <- read.dat("~/Downloads/STA 490/Proj23/GSS.dat", GSS_metadata)
attr(GSS_ascii, "col.label") <- GSS_metadata[["ColLabel"]]
GSS <- GSS_ascii
```


```{r filtering to year 2022, echo=FALSE, include=FALSE}
library(dplyr)
library(tidyverse)
library(knitr)
gss22 <- GSS %>% 
  filter(YEAR==2022)
gss22
```

```{r, proportions of Administered Ballots in 2022, message=FALSE, echo=FALSE, include=FALSE}

ballotcounts <- gss22  %>% 
  group_by(BALLOT) %>% 
  summarize(count=n())

kable(ballotcounts, caption="Counts of the Ballots Adminstered in 2022")
```

Because the response variables of interest were administered on one of the three GSS ballots, the data set was restricted to respondents who received that ballot. In addition, neutral responses (“Don’t know/unsure”) for the response variables **HUBBYWK1** and **FAMSUFFR** and the variable **MARTYPE** were  excluded.  These restrictions resulted in a sample of 803 respondents. 

```{r filtering the population to Ballot A, echo=FALSE, include=FALSE, message=FALSE}


gss22 <- gss22 %>% 
  filter(BALLOT==1) %>% 
  select( WRKSTAT,HRS1,MARITAL,AGE,DEGREE,SEX,RACE,BORN,INCOME,REGION,POLVIEWS,FAMSUFFR,HUBBYWK1,MARTYPE)
gss22
```



```{r recategorizing variables and removing NAs, echo=FALSE, include=FALSE}

GSS22 <- gss22 %>% 
  filter(HUBBYWK1 != 3 & FAMSUFFR != 3 & MARTYPE !=3)
GSS22

####Removing NA's 
GSS22$WRKSTAT <- replace(GSS22$WRKSTAT, GSS22$WRKSTAT < 0, NA)
GSS22$HRS1 <- replace(GSS22$HRS1, GSS22$HRS1 < 0, NA)
GSS22$MARITAL <- replace(GSS22$MARITAL, GSS22$MARITAL < 0, NA)
GSS22$AGE <- replace(GSS22$AGE, GSS22$AGE < 0, NA)
GSS22$DEGREE <- replace(GSS22$DEGREE, GSS22$DEGREE < 0, NA)
GSS22$SEX <- replace(GSS22$SEX, GSS22$SEX < 0, NA)
GSS22$RACE <- replace(GSS22$RACE, GSS22$RACE < 0, NA)
GSS22$BORN <- replace(GSS22$BORN, GSS22$BORN < 0, NA)
GSS22$INCOME <- replace(GSS22$INCOME, GSS22$INCOME < 0, NA)
GSS22$REGION <- replace(GSS22$REGION, GSS22$REGION < 0, NA)
GSS22$POLVIEWS <- replace(GSS22$POLVIEWS, GSS22$POLVIEWS < 0, NA)
GSS22$FAMSUFFR <- replace(GSS22$FAMSUFFR, GSS22$FAMSUFFR < 0, NA)
GSS22$HUBBYWK1 <- replace(GSS22$HUBBYWK1, GSS22$HUBBYWK1< 0, NA)
GSS22$MARTYPE <- replace(GSS22$MARTYPE, GSS22$MARTYPE < 0, NA)



GSS22 <- GSS22 %>% 
  mutate(WRKSTAT= case_when(WRKSTAT==1~ "Working Full-Time", 
                            WRKSTAT==2~ "Working Part-Time", 
                            WRKSTAT==3~ "With Job But Not at Work Due to Certain Reasons", 
                            WRKSTAT==4~ "Unemployed, Laid Off, Looking for Work", 
                            WRKSTAT==5~ "Retired",
                            WRKSTAT==6~ "In School", 
                            WRKSTAT==7~ "Keeping House", 
                            WRKSTAT==8~ "Other")) %>% 
  mutate(HRS1= case_when(HRS1 >= 0 & HRS1 <= 15 ~ "Worked 0-15 Hours",
                         HRS1 >= 16 & HRS1 <= 30 ~ "Worked 16-30 Hours", 
                         HRS1 >= 31 & HRS1 <=40 ~ "Worked 31-40 Hours", 
                         HRS1 >= 41 & HRS1 <= 50 ~ "Worked 41-50 Hours", 
                         HRS1 >= 51 & HRS1 <= 60 ~ "Worked 51-60 Hours", 
                         HRS1 >= 61 & HRS1 <= 75 ~ "Worked 61-75 Hours", 
                         HRS1 >= 76 & HRS1 <= 89 ~ "Worked 76-89 Hours")) %>% 
  mutate(MARITAL = case_when(MARITAL== 1 ~ "Married", 
                             MARITAL== 2 ~ "Widowed", 
                             MARITAL== 3 ~ "Divorced", 
                             MARITAL== 4 ~ "Seperated", 
                             MARITAL== 5 ~ "Never Married")) %>% 
  mutate(AGE = case_when(AGE==18 & AGE==19 ~ "18 and 19 Years Old",
                         AGE>=20 & AGE<=29 ~ "20 to 29 Years Old",
                         AGE>=30 & AGE<40~"30 to 39 Years Old",
                         AGE>=40 & AGE<=49~"40 to 49 Years Old",
                         AGE>=50 & AGE<=59~"50 to 59 Years Old",
                         AGE>=60 & AGE<=69~"60 to 69 Years Old",
                         AGE>=70 & AGE<=79~"70 to 79 Years Old",
                         AGE>=80 & AGE<=89~"80 to 89 Years Old")) %>% 
  mutate(DEGREE = case_when(DEGREE == 0~ "Less than High School", 
                            DEGREE == 1~ "High School", 
                            DEGREE == 2~ "Associate Degree",
                            DEGREE == 3~ "Bachelor's", 
                            DEGREE == 4~ "Graduate")) %>% 
  mutate(SEX = case_when(SEX == 1~ "Male", 
                         SEX == 2~ "Female")) %>% 
  mutate(RACE= case_when(RACE== 1~ "White", 
                         RACE==2~ "Black", 
                         RACE==3~ "Other")) %>%  
  mutate(BORN= case_when(BORN==1~ "Born in the US", 
                         BORN==2~ "Not Born in the US")) %>% 
  mutate(INCOME = case_when(INCOME <= 1 ~ "Under $1,000", 
                            INCOME >= 2 & INCOME <= 4 ~ "From $1,000 to $4,999", 
                            INCOME >= 5 & INCOME <= 8 ~ "From $5,000 to $9,999",
                            INCOME >= 9 & INCOME <= 11 ~ "From $10,000 to $24,999", 
                            INCOME >= 12 ~ "$25,000 or More")) %>% 
  mutate(REGION = case_when(REGION == 1~ "New England",
                            REGION == 2~ "Middle Atlantic", 
                            REGION == 3~ "Midwest",
                            REGION == 4~ "Midwest", 
                            REGION == 5~ "South Atlantic", 
                            REGION == 6 ~ "South",
                            REGION == 7~ "South", 
                            REGION == 8~ "Mountain",
                            REGION == 9~ "Pacific")) %>% 
  mutate(POLVIEWS = case_when(POLVIEWS == 1~ "Extremely Liberal", 
                              POLVIEWS == 2~ "Liberal", 
                              POLVIEWS == 3~ "Slightly Liberal", 
                              POLVIEWS == 4~ "Moderate", 
                              POLVIEWS == 5~ "Slightly Conservative", 
                              POLVIEWS == 6~ "Conservative", 
                              POLVIEWS == 7~ "Extremely Conservative")) %>% 
  mutate(MARTYPE = case_when(MARTYPE == 1~ "Marriage between a man and woman", 
                            MARTYPE == 2~ "Same Sex Marriage"))



```
 Data cleaning steps were performed on the study variables. Negative survey codes indicating a lack of response were assigned as missing values and the explanatory variables were re-categorized to improve interpretability.The response variables, **HUBBYWK1** and **FAMSUFFR**, were originally measured on a five-point Likert scale (1=Strongly Agree to 5 = Strongly Disagree). Neutral responses were excluded and the scale was condensed into two categories: **1** for **agree** and **2** for **disagree**. 

```{r recategorizing response variables, echo=FALSE, include=FALSE}
library(knitr)
gss22_r <- GSS22 %>% 
  mutate(HUBBYWK1= case_when(HUBBYWK1 == 1 ~ 1, 
                             HUBBYWK1 == 2 ~ 1, 
                             HUBBYWK1 == 4 ~ 2,
                             HUBBYWK1 == 5 ~ 2))
count_r1 <- gss22_r %>% 
  group_by(HUBBYWK1) %>% 
  summarize(count=n())

kable(count_r1, caption="Counts For The Variable HUBBYWK1")



gss22_r <- gss22_r %>% 
  mutate(FAMSUFFR= case_when(FAMSUFFR == 1 ~ 1,
                             FAMSUFFR == 2 ~ 1,
                             FAMSUFFR == 4 ~ 2, 
                             FAMSUFFR  == 5 ~ 2))
count_r2 <- gss22_r %>% 
  group_by(FAMSUFFR) %>% 
  summarize(count=n())
kable(count_r2, caption="Counts For The Variable FAMSUFFR")

```


```{r counts, echo=FALSE, include=FALSE}
count_age <- gss22_r %>% 
  group_by(AGE) %>% 
  summarize(count=n())
kable(count_age, caption="Counts For The Variable AGE")

count_born <- gss22_r %>% 
  group_by(BORN) %>% 
  summarize(count=n())
kable(count_born, caption="Counts For The Variable BORN")

count_deg <- gss22_r %>% 
  group_by(DEGREE) %>% 
  summarize(count=n())
kable(count_deg, caption="Counts For The Variable DEGREE")

count_inc <- gss22_r %>% 
  group_by(INCOME) %>% 
  summarize(count=n())
kable(count_inc, caption="Counts For The Variable INCOME")


count_hrs <- gss22_r %>% 
  group_by(HRS1) %>% 
  summarize(count=n())
kable(count_hrs, caption="Counts For The Variable HRS1")

count_marry <- gss22_r %>% 
  group_by(MARITAL) %>% 
  summarize(count=n())
kable(count_marry, caption="Counts For The Variable MARITAL")

count_mar <- gss22_r %>% 
  group_by(MARTYPE) %>% 
  summarize(count=n())
kable(count_mar, caption="Counts For The Variable MARTYPE")

count_pol <- gss22_r %>% 
  group_by(POLVIEWS) %>% 
  summarize(count=n())
kable(count_pol, caption="Counts For The Variable POLVIEWS")

count_race <- gss22_r %>% 
  group_by(RACE) %>% 
  summarize(count=n())
kable(count_race, caption="Counts For The Variable RACE")

count_reg <- gss22_r %>% 
  group_by(REGION) %>% 
  summarize(count=n())
kable(count_reg, caption="Counts For The Variable REGION")

count_sex <- gss22_r %>% 
  group_by(SEX) %>% 
  summarize(count=n())
kable(count_sex, caption="Counts For The Variable SEX")

count_wrk <- gss22_r %>% 
  group_by(WRKSTAT) %>% 
  summarize(count=n())
kable(count_wrk, caption="Counts For The Variable WRKSTAT")
```



#### Multiple Imputation For Missing Values

Missing values were addressed using multiple imputation with the `mice` package in R. All variables were converted to factors and missingness patterns were assessed. The variable **MARTYPE** had the most missing values but imputation was performed to retain these observations.  

  

```{r prep for MICE, echo=FALSE}
gss22_imp <- gss22_r

#categorical variables must be a factor for MICE package
gss22_imp$WRKSTAT <- as.factor(gss22_imp$WRKSTAT)
gss22_imp$HRS1 <- as.factor(gss22_imp$HRS1)
gss22_imp$MARITAL <- as.factor(gss22_imp$MARITAL)
gss22_imp$AGE <- as.factor(gss22_imp$AGE)
gss22_imp$DEGREE <- as.factor(gss22_imp$DEGREE)
gss22_imp$SEX <- as.factor(gss22_imp$SEX)
gss22_imp$RACE <- as.factor(gss22_imp$RACE)
gss22_imp$BORN <- as.factor(gss22_imp$BORN)
gss22_imp$INCOME <- as.factor(gss22_imp$INCOME)  
gss22_imp$REGION <- as.factor(gss22_imp$REGION)
gss22_imp$POLVIEWS <- as.factor(gss22_imp$POLVIEWS)
gss22_imp$FAMSUFFR <- as.factor(gss22_imp$FAMSUFFR)
gss22_imp$HUBBYWK1 <- as.factor(gss22_imp$HUBBYWK1)
gss22_imp$MARTYPE <- as.factor(gss22_imp$MARTYPE)
```

```{r libraries for MICE, message=FALSE, echo=FALSE}
library(mice)
library(VIM)
library(ggmice)
```


```{r more data visualization before MICE, echo=FALSE, message=FALSE, include=FALSE}
library(ggplot2)
library(naniar)
gg_miss_var(gss22_imp)
```
                                                                                                                                              


```{r, echo=FALSE, message=FALSE, include=FALSE}
plot_pattern(
  gss22_imp,
  square = TRUE,
  rotate = TRUE,
  npat=25
)
```

Predictive mean matching was used to generate five imputed data sets with 25 iterations which were then pooled into a single complete data set. Split plots were created for variables with missing values to confirm that the imputed distributions aligned with the observed data (figures below). 
The resulting data set was used for analysis, ensuring that missing values did not bias the results. 
 
  
```{r running MICE, echo=FALSE, include=FALSE, message=FALSE}
options(scipen=999)
gss22_m <- mice(gss22_imp, m=5, maxit=25, method="pmm", seed=500)
summary(gss22_m)

completedData <- complete(gss22_m,1)
```

```{r, echo=FALSE, include=FALSE}
ggmice(gss22_m, aes(x=.imp, y=HRS1)) + geom_jitter(width=0.25) + 
  labs(x = "Imputation number")

ggmice(gss22_m, aes(x=.imp, y= INCOME)) + geom_jitter(width=0.25) + 
  labs(x = "Imputation number")
ggmice(gss22_m, aes(x=.imp, y= POLVIEWS)) + geom_jitter(width=0.25) +
  labs(x = "Imputation number")
```

The figures below for the variables **MARTYPE**, **HUBBYWK1** and **FAMSUFFR** show the distribution of values across multiple imputations, with each imputation being represented by a distinct color. These plots show that imputed values align with the observed data and preserve the original data distribution. 
```{r MICE data visualization of variables with most missing values, echo=FALSE, message=FALSE, warning=FALSE, fig.width = 8, fig.asp = .40}

ggmice(gss22_m, aes(x=.imp, y= MARTYPE, color=factor(.imp))) + geom_jitter(width=0.25, alpha = 0.6) + 
  labs(x = "Imputation number", y="MARTYPE", color="Imputation") + theme_minimal()

ggmice(gss22_m, aes(x=.imp, y= HUBBYWK1, color=factor(.imp))) + geom_jitter(width=0.25, alpha=0.6) + 
  labs(x = "Imputation number", y="HUBBYWK1", color="Imputation") + theme_minimal()

ggmice(gss22_m, aes(x=.imp, y= FAMSUFFR, color=factor(.imp))) + geom_jitter(width=0.25, alpha=0.6) + 
  labs(x = "Imputation number", y="FAMSUFFR", color="Imputation") + theme_minimal()

```


## Research Question 1 
 To address the research question, a logistic regression model was built with the imputed data. The first model tested the significance between the response variable **HUBBYWK1** and the explanatory variables. 

  
```{r building logistic regression models for question 1, echo=FALSE, include=FALSE}
model1 <-with(gss22_m, glm(HUBBYWK1~WRKSTAT+HRS1+MARITAL+AGE+DEGREE+SEX+RACE+BORN
                           +INCOME+REGION+POLVIEWS+MARTYPE, family=binomial))
model1_table <- summary(pool(model1)) 
kable(model1_table, caption="Estimates from Log Reg Model of Response HUBBYWK1", digits=3)

```
Using a significance level of α = 0.05, the following variables were found to have a statistically significant relationship: 

 + DEGREE (Graduate)                                              → p = 0.012
 + SEX (Male)                                                     → p = 0.016
 + RACE (White)                                                   → p = 0.030
 + BORN (Not born in US)                                          → p = 0.008
 + REGION (South)                                                 → p = 0.039
 + POLVIEWS (Slightly Liberal,Liberal,Extremely Liberal,Moderate) → p = < 0.001
 

The results of the Hosmer-Lemeshow Goodness of Fit test indicate that the model is a good fit for the data, since the p.value is larger than 0.05 and is close to 1. 
```{r, HL GOF, message=FALSE, echo=FALSE, include=FALSE }
library(mitools)
X1 <- rep(NA, length(model1$analyses))

# Compute chi-squared statistic on each imputation
# (and store the degrees of freedom, as well)
for(i in 1:length(X1)) {
  HL1 <- ResourceSelection::hoslem.test(model1$analyses[[i]]$y,
                                       model1$analyses[[i]]$fitted.values)
  X1[i] <- HL1$statistic # Chi-squared value
  DF    <- HL1$parameter # Degrees of freedom
  rm(HL1)
}

comb <- miceadds::micombine.chisquare(X1, DF )


```

Stacked bar charts were created for the statistically significant variables. These plots show that a large proportion of respondents who identify as liberal disagree with the survey statement that **men should work while women stay at home**. 
Similarly, respondents with a graduates degree and those who were not born in the United States are more likely to disagree with the survey question, indicating less support for traditional gender roles within these groups. 

```{r, stacked bar charts for HUBBYWK1 and explanatory variables, echo=FALSE, fig.height=8, fig.width=10}

question_one_graphs <- completedData %>% 
  select(HUBBYWK1, POLVIEWS, DEGREE, SEX, REGION) %>% 
  pivot_longer(
    cols=c(POLVIEWS, DEGREE, SEX, REGION), 
    names_to = "variable", 
    values_to ="category"
  )

ggplot(question_one_graphs, aes(x=category, fill=HUBBYWK1)) + geom_bar(position="stack")  + facet_wrap(~variable, scales="free_y") + coord_flip() + scale_x_discrete(labels = function(x) str_wrap(x, width = 12)) + scale_fill_brewer(palette= "Pastel1", labels = c("AGREE", "DISAGREE")) + 
  labs ( title="Agreement with Husband Works and Wife Stays at Home", x="", y = "Number of Respondents") +  theme(panel.spacing = unit(2, "lines"), strip.text=element_text(size=10))


```

Finally, to better understand the significance of **REGION** (South), this variable was examined in relation to certain demographics like **RACE**, **POLVIEWS**, and **SEX**. While the south contains a larger proportion of White respondents compared to other racial groups, there are no clear patterns in political views or gender that appear to explain the statistical significance found in the Southern region. This suggests that other unmeasured social, cultural, or contextual factors may contribute to the observed relationship between region and attitudes towards traditional gender roles. 

### Question 2 

For the second response variable, **FAMSUFFR**, a logistic regression model was fit using the imputed data. 
```{r model2, echo=FALSE, include=FALSE}
model2 <-with(gss22_m, glm(FAMSUFFR~WRKSTAT+HRS1+MARITAL+AGE+DEGREE+SEX+RACE+BORN
                           +INCOME+REGION+POLVIEWS+MARTYPE, family=binomial))
model2_table <- summary(pool(model2)) 
kable(model2_table, caption="Estimates from Log Reg Model of Response FAMSUFFR", digits=3)
```
At a significance level of α = 0.05, the following variables were found to have a statistically significant relationship with FAMSUFFR: 

 + AGE (60 to 69 Years)          → p.value (0.028)
 + DEGREE (Graduate)             → p.value (0.011)
 + SEX (Male)                    → p.value (0.018)
 + BORN (Not born in US)         → p.value (0.001)
 + POLVIEWS (Liberal)            → p.value (0.007)
 + POLVIEWS (Extremely Liberal)  → p.value (0.002)
 + POLVIEWS (Slightly Liberal)   → p.value (0.038)

The Hosmer Lemeshow Goodness of fit test indicated that the model fit the data (p > 0.05). 

```{r running H-L on model 2, echo=FALSE, include=FALSE}

X2 <- rep(NA, length(model2$analyses))
for(i in 1:length(X2)) {
  HL2 <- ResourceSelection::hoslem.test(model2$analyses[[i]]$y,
                                       model2$analyses[[i]]$fitted.values)
  X2[i] <- HL2$statistic # Chi-squared value
  DF    <- HL2$parameter # Degrees of freedom
  rm(HL2)
}

comb2 <- miceadds::micombine.chisquare(X2, DF )
```

Stacked bar charts were created with the statistically significant variables:
```{r plots for question 2, echo=FALSE, fig.height=8, fig.width=10}

question_two_graphs <- completedData %>% 
  select(FAMSUFFR, AGE, POLVIEWS, DEGREE, SEX, BORN) %>% 
  pivot_longer(
    cols=c(AGE, POLVIEWS, DEGREE, SEX, BORN), 
    names_to = "names", 
    values_to ="values"
  )
ggplot(question_two_graphs, aes(x=values, fill=FAMSUFFR)) + geom_bar(position="stack")  + facet_wrap(~names, scales="free_y") + coord_flip() + scale_x_discrete(labels = function(x) str_wrap(x, width = 12)) + scale_fill_brewer(palette= "Pastel2", labels = c("AGREE", "DISAGREE")) + 
  labs ( title="Agreement with Family Life Suffers When Women Work Full Time", x="", y = "Number of Respondents") +  theme(panel.spacing = unit(2, "lines"), strip.text=element_text(size=10))

```

Consistent with the results from the first model, the variable **DEGREE** remained a significant predictor: respondents with a graduate degree were more likely to disagree with the survey statement. **POLVIEWS** also showed a strong association with **FAMSUFFR**. Respondents identifying with liberal political views were more likely to disagree with the statement: family life suffers when women work full time, compared to those identifying as conservative, who had mixed responses. 


## Conclusion 

This study examined attitudes towards traditional gender roles using data from the 2022 General Social Survey and whether demographic characteristics and political ideology relate to these attitudes. 
Across both models, political ideology emerged as the most consistent predictor, which respondents identifying as liberal most likely to disagree with traditional gender roles. Educational attainment also showed a meaningful association, as respondents with graduate degrees were more likely to oppose traditional gender norms. 
This analysis is subject to several limitations. The GSS is cross-sectional, which limits interpretation to a proportion of the population and responses are self reported. Additionally, multiple imputation for missing values may introduce some uncertainty despite checks indicating reasonable model fit. Future research could explore longitudinal trends in attitudes towards gender roles or examine interactions between political ideology and other demographics in greater depth.  